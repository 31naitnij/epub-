# AI EPUB 电子书翻译工具

这是一个调用大模型API的 **EPUB 电子书翻译工具**。能够在翻译时实现**100% 保留原书的排版、插图和样式**。

---

## ✨ 特征

- **排版零损坏**：通过特殊符号作为锚点，提取文本再插入，实现只翻译文字，保持图片、字体、表格、排版布局完全不变。
- **分块与分组**：将文本按照段落分块，再按照设定的“分块大小”将若干块合并发送，增加整体性。
- **多轮对话**：可以设置1-5伦次翻译结果，将前次的结果作为当前翻译的参考，增加连贯性。
- **断点续傳**：过程设置了缓存，支持断点续传。

---

## 🚀 使用说明

### 方式一：直接下载使用（推荐）
前往本仓库的 **[Releases](https://github.com/31naitnij/AI-EPUB-Translator/releases)** 页面。

### 方式二：通过代码运行
如果你想体验最新功能或进行修改，可以按以下步骤运行：

#### **Windows 系统：**
- 双击文件夹里的 **`run.bat`**。它会自动帮你准备环境并启动。

#### **macOS / Linux 系统：**
1. 打开“终端 (Terminal)”。
2. 进入本项目文件夹，输入以下命令并回车：
   ```bash
   bash run.sh
   ```

---

### 方式三：自己打包成软件 (EXE/APP)
如果你想把源代码打包成一个独立的软件，可以使用我们提供的脚本：

- **Windows 用户**：双击 **`build_exe.bat`**。完成后，软件会出现在 `dist` 文件夹里。
- **macOS 用户**：在终端运行 `bash build_macos.sh`。

---

## 🛠 翻译具体步骤
成功运行后，会出现UI界面：
1. **选择书籍**：点击“选择文件”，找到你想翻译的 `.epub` 电子书。
2. **指定目录**：选择缓存和输出文件夹，建议固定在一个位置。
3. **填入 API 信息**：填写你的 AI Key和URL、模型名，这需要参考你调用的大模型API文档，设置合适的温度值，越严谨的文档温度值越低，建议在0-1之间。
4. **划分段落**：设置分块字符数，并点击 **“分块并分组”**，软件会根据设定值分块，预备发送给AI。根据模型能力，建议不要过大，2000以内。
5. **设置提示词**：因为设置了锚点符号，需要在提示词里提醒AI注意保留这些符号和格式。下面提供了提示词参考。
6. **开始翻译**：点击 **“开始翻译”**。你会看到右侧进度不断增加。
7. **导出书籍**：翻译完成后，点击 **“导出”**。一本翻译好的新书就会出现在你的文件夹里！

---

## 💡 小提示

- **导出失败**：如果在点击“导出”时报错，通常是因为你正在用阅读器（如微信读书查看器、Calibre、Apple Books）打开那本生成的文件。请**关闭阅读器**后再试。
- **分块大小不满意**：需要点击“清除缓存”再重新分块并分组。

---

## 🔍 关于翻译中出现的特殊符号

在翻译过程中，你会在原文和译文框里看到一些奇怪的符号（如 `⟬⟭`, `⦗1⦘`, `⟦ ⟧` 等），请**不要删除或修改它们**：

- **它们是什么？**：这些是给 AI 看的“定位锚点”。它们代表了书中的加粗、倾斜、链接、换行或图片等格式信息。
- **为什么要用它？**：有了这些符号，AI 就能知道哪里需要保留原有的格式，从而保证翻译后的排版和原书一模一样。
- **导出会出现在书里吗？**：**绝对不会**。在最后点击“导出”时，软件会自动把这些符号变回原来的精美排版，你在手机或 Kindel 上看书时是看不到这些符号的。

---

## 📝 提示词示例 (Prompt Example)

你是一位资深翻译专家，精通各国语言。你要将以下文本翻译为中文，并严格执行以下规则：

1.**专业要求**
-术语规范：专业术语需符合各领域通用或学界公认的译名。
-语言风格：译文需准确、严谨、流畅，符合中文相应领域的专业表述习惯。
-保留原文术语：原文中出现的非中文词汇（如希腊文、希伯来文、拉丁文、梵文等）或特定的学术缩写、专有名词，请在译文中原样保留。

2. **标记规则**（绝对禁区，不可触碰）
-本系统使用了一套精密且稀有的数学符号作为排版锚点，请务必保持它们在译文中的位置、编号及完整性与原文完全一致：
-容器标记：⟬ ⟭ 表示一组段落的开始和结束，请勿丢失。
-块分隔符：⧖, ⧗, ⧘, ⧙ 等成对出现的稀有字符用于分隔段落，严禁将其替换成其他字符或丢失。
-内部锚点：⟦ ⟧ (双括号) 和 ⦗n⦘ (编号锚点) 代表加粗、链接、图片或注脚。请仅翻译 ⟦ ⟧ 内部的文字，并保留其后的 ⦗n⦘ 编号。

3. **输出指南**
-纯净输出：严禁输出任何自我介绍、翻译说明或“好的，这是翻译”之类的话。
-直接返回：从第一个 ⟬ 字符开始输出，到最后一个 ⟭ 字符结束。
-禁止格式化：严禁添加 Markdown 代码块（如 ```）或额外的加粗效果。

4. **示例对比**
-原文：⟬ ⧖Under the provisions of the ⟦Research Collaboration Agreement⟧⦗1⦘...⧖ ⟭
-译文：⟬ ⧖根据⟦研究合作协议⟧⦗1⦘的规定……⧖ ⟭

开始翻译：



---
> [!NOTE]
> 本工具目前仅支持 `.epub` 格式。如果你手头是 PDF 或 Word，建议先使用 Calibre 等工具转换成 EPUB 再进行翻译。
