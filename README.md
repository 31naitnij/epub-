# AI EPUB 翻译工具 (AI EPUB Translator)

这是一个利用 Google Antigravity 辅助开发的 AI EPUB 翻译工具，旨在为非专业用户提供简单且高质量的电子书翻译方案。

## 🌟 设计理念

- **保全格式细节**：不盲目提取 HTML 文本，而是转换成 Markdown 以精简 tokens 并防止翻译后的 HTML 结构错位，翻译完成后再重新回贴回 EPUB。
- **长文本上下文感应**：采用“前文翻译 -> 待译正文”的多轮对话架构，支持 **1-5 轮可调上下文**，确保长篇连贯性。
- **稳定顺序翻译**：为确保翻译逻辑的严密统一，目前采取顺序翻译模式（暂未支持章节并发，以避免复杂 EPUB 结构下的逻辑混乱）。

## 🚀 快速开始

### 1. 直接下载运行 (推荐 Windows 用户)
1. 在仓库右侧的 **Releases** 页面下载最新压缩包。
2. 解压后，双击 `AI_EPUB_Translator.exe` 即可直接使用（无需安装 Python 环境）。

### 2. 源码脚本启动 (全平台)
1. 确保系统安装了 Python 3.10 或更高版本。
2. 克隆或下载本项目源码，进入根目录。
3. **Windows**: 双击 `run.bat`。
4. **macOS/Linux**: 终端执行 `bash run.sh`。
*脚本会自动配置虚拟环境并安装所需依赖。*

### 3. macOS 用户生成 App 
若需要生成一个可作为独立应用双击使用的 `.app` 程序：
1. 打开终端进入本项目根目录。
2. 执行 `bash build_macos.sh`。
3. 构建完成后，在 `dist/` 文件夹下即可找到 `AI_EPUB_Translator.app`。

## 🛠️ 使用步骤

1. **设置路径**：选择你要翻译的 EPUB 文件，指定输出和缓存目录。
2. **配置 API 项**：
   - 填写 **API Key** 和 **Base URL** (如 `https://api.deepseek.com`)。
   - 填写 **模型名称**（请参照 API 提供商文档，如 `deepseek-chat`）。
   - **设置上下文轮数**：范围 1-5 轮。默认为 1 轮，对文学类连贯性要求高的内容可适当增加。
3. **分块处理**：点击 **“仅分块处理”**。如果分块结果不理想，可清除缓存并调整分块大小重新操作。
4. **执行翻译**：
   - 点击 **“全部翻译”** 自动完成全书。
   - 或选中特定区块，通过 **“翻译当前块”** 进行效果测试。
5. **导出图书**：翻译完成后，点击 **“导出 EPUB”**，程序将执行数据回填并生成最终文件。

## 📂 项目结构

- `src/core/`：核心逻辑（转换器、数据处理器、AI 翻译驱动）。
- `src/ui/`：基于 PySide6 构建的图形用户界面。
- `dist/`：打包生成的发布版应用程序。
- `build_exe.bat` / `build_macos.sh`：平台特定的打包自动化脚本。

## ⚠️ 注意事项

- **缓存同步**：如果您中途修改了“分块大小”或提示词，请务必先点击“清除缓存”以确保数据一致性。
- **长度平衡**：建议分块大小适中。过大的块可能导致更好的整体感，但也会增加 AI 报错或超时的概率。
- **资源消耗**：开启多轮上下文（>1）会增加每次翻译的 tokens 消耗，速度也会相应减慢。

## 🛡️ License
[MIT License](LICENSE)
