# AI EPUB 翻译工具 (AI EPUB Translator)

这是一个基于 AI API (支持 DeepSeek, OpenAI 等) 的 EPUB 电子书对照翻译工具。它采用物理回填技术，在保证 100% 还原电子书原始布局（CSS, 样式, 图片, 元数据）的同时，提供流畅的、如同对话般的翻译体验。

## 🌟 核心特性

- **1:1 结构还原**：采用“物理解压-内容替换-重新打包”的工作流，确保翻译后的 EPUB 目录、样式、图片完全不动，仅文字被翻译。
- **智能多轮对话上下文**：按照 DeepSeek 全新标准，发送 `User(前文原) -> Assistant(前文译) -> User(当前待译)` 的多轮对话结构，极大提升前后文词汇的一致性。
- **流式实时显示**：译文像网页版 AI 一样动态逐字输出，翻译进度一目了然。
- **精细化控制**：
  - **仅分块处理**：先完成书籍解析和逻辑分块，预览效果。
  - **翻译当前块**：支持对选中的特定区块进行单独翻译/重新翻译。
  - **全部翻译**：一键自动化全书翻译，支持断点续传。
- **神学翻译优化**：内置针对基督教神学文献优化的专业提示词（System Prompt）预设。
- **可调节布局**：界面面板支持手动拉伸大小，自适应各种屏幕尺寸。

## 🚀 快速开始

### 方式一：直接运行 (推荐)
1. 下载项目后，进入 Windows 文件夹。
2. 双击 `dist/AI_EPUB_Translator.exe` 即可直接运行（无需安装 Python）。

### 方式二：脚本启动 (环境隔离)
1. 确保安装了 Python 3.10+。
2. 双击运行 `run.bat` (Windows) 或执行 `bash run.sh` (macOS/Linux)。脚本会自动安装依赖并启动。

## 🛠️ 使用步骤

1. **设置路径**：选择要翻译的 EPUB 文件，并指定缓存和输出目录。
2. **配置 API**：
   - 填写 API Key 和 Base URL (如 `https://api.deepseek.com`)。
   - 选择模型（推荐 `gpt-4o` 或 `deepseek-chat`）。
   - 设置提示词（已内置神学专业预设）。
3. **处理分块**：点击 **“仅分块处理”**。
4. **开始翻译**：
   - 点击 **“全部翻译”** 以自动完成全书，或
   - 选中某个区块，点击 **“翻译当前块”** 进行测试。
5. **导出图书**：全部完成后，点击 **“导出 EPUB”**，程序将执行物理回填并打包。

## 📂 项目结构

- `src/core/`：核心逻辑（转换器、处理器、翻译驱动）。
- `src/ui/`：基于 PySide6 的图形界面。
- `dist/`：发布版可执行文件。
- `build_exe.bat`：Windows 打包脚本。
- `build_macos.sh`：macOS 打包脚本。

## ⚠️ 注意事项

- **缓存管理**：如果您修改了“分块大小”或提示词，建议先点击“清除缓存”再重新开始，以保证数据一致性。
- **术语一致性**：本项目依靠上下文参考机制维持一致性，建议使用推理能力较强的模型（如 GPT-4 / DeepSeek-V3）。

## 🛡️ License
[MIT License](LICENSE)
