# AI 文档翻译助手 (EPUB/DOCX)

这是一个调用大模型 API 的 **电子书与文档翻译工具**。它的目标是：让你在翻译内容的同时，**100% 保留原文件的排版、插图和样式**。

---

## ✨ 特征

- **排版零损坏**：通过特殊符号作为锚点，提取文本再插入，实现只翻译文字，保持图片、字体、表格、排版布局完全不变。
- **分块与分组**：将文本按照段落分块，再按照设定的“分块大小”将若干块合并发送，增加整体性。
- **多轮对话**：可以设置 1-5 轮次翻译历史参考，增加译文的连贯性。
- **断点续傳**：过程设置了缓存，即便程序中断，重新启动后也能从上次进度继续。

---

## 🚀 使用说明

### 方式一：直接下载使用（推荐）
前往本仓库的 **[Releases](https://github.com/31naitnij/AI-EPUB-Translator/releases)** 页面下载适合您系统的版本。

### 方式二：通过代码运行
如果您想体验最新功能或进行修改，可以按以下步骤运行：

#### **Windows 系统：**
- 双击文件夹里的 **`run.bat`**。它会自动准备环境并启动。

#### **macOS / Linux 系统：**
1. 打开“终端 (Terminal)”。
2. 进入本项目文件夹，输入以下命令并回车：
   ```bash
   bash run.sh
   ```

---

### 方式三：自己打包成软件 (EXE/APP)
如果您想把源代码打包成独立的软件，可以使用提供的脚本：

- **Windows 用户**：双击 **`build_exe.bat`**。
- **macOS 用户**：在终端运行 `bash build_macos.sh`。

---

## 🛠 翻译具体步骤

成功运行后，会出现 UI 界面：
1. **选择文件**：点击“选择文件”，找到您想翻译的 `.epub` 或 `.docx` 文件。
2. **指定目录**：选择缓存和输出文件夹。
3. **填入 API 信息**：填写您的 AI Key、URL 和模型名。建议根据文档严谨程度设置合适的温度值（建议 0.1 - 0.7）。
4. **划分段落**：设置分块字符数，并点击 **“分块并分组”**。软件会根据设定值分块，预备发送给 AI。建议设为 1000 - 2000。
5. **设置提示词**：软件已提取格式标记。请在提示词中提醒 AI 保留这些特殊符号（详见下方的提示词参考）。
6. **开始翻译**：点击 **“开始翻译”**。
7. **导出文件**：翻译完成后，点击 **“导出”**。

---

## 💡 小提示

- **导出失败**：通常是因为您正使用阅读器（如微信读书、Calibre、Apple Books）打开着该文件。请**关闭阅读器**后再试。
- **分块大小不满意**：点击“清除缓存”后重新调整参数并分块。

---

## 🔍 关于翻译中出现的特殊符号

在翻译过程中，您会在预览框里看到一些特殊符号（如 `⟬⟭`, `⦗1⦘`, `⟦ ⟧` 等），请**不要删除或修改它们**：

- **它们是什么？**：这些是“定位锚点”，代表了文件中的加粗、倾斜、链接、换行或图片等格式信息。
- **导出会出现在结果中吗？**：**绝对不会**。在导出时，软件会自动将这些符号还原为原来的精美排版。

---

# 📝 提示词示例

## 角色和工作
你是一位精通多语言的资深翻译专家，专业处理各类文本翻译。你要将给定文本中的英文翻译为中文，遵循以下规则：

### 1. 术语与风格
- 术语统一，使用领域通用译名。
- 译文准确严谨，符合中文表达习惯。
- 保留原文非英文词汇、学术缩写和专有名词。

### 2. 标记处理（绝对禁止修改）
- **容器标记**：⟬ ⟭ （必须保持完整）
- **块分隔符**：⧖ ⧗ ⧘ ⧙ （必须成对出现，严禁替换）
- **内部锚点**：⟦文字⟧⦗n⦘ （只翻译 ⟦ ⟧ 内的文字，保留 ⦗n⦘ 编号）

### 3. 输出要求
- 直接从 ⟬ 开始输出，到 ⟭ 结束。
- 不添加任何自我介绍、说明文字或代码块。

## 示例
**原文**：⟬ ⧖Under the provisions of the ⟦Research Collaboration Agreement⟧⦗1⦘...⧖ ⟭  
**译文**：⟬ ⧖根据⟦研究合作协议⟧⦗1⦘的规定……⧖ ⟭

---
> [!NOTE]
> 本工具目前支持 `.epub` 和 `.docx` 格式。
